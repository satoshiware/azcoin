x-common: &common
  image: azcoin-node:dev
  environment:
    environment:
    AZCOIN_DATA: /data
    MICRO: azcoin
    P2P_PORT: 19333
    RPC_PORT: 19332
    RPC_USER: azrpc
    RPC_PASSWORD: azrpcpass

services:
  seed:
    <<: *common
    build:
      context: ../..
      dockerfile: contrib/docker/Dockerfile
      args:
        MICRO: azcoin
    container_name: azcoin-seed
    ports:
      - "19333:19333"
      - "19332:19332"
    volumes:
      - seed_data:/data
    command: ["-dnsseed=0", "-listen=1"]

  peer1:
    <<: *common
    container_name: azcoin-peer1
    depends_on: [seed]
    volumes:
      - peer1_data:/data
    command: ["-dnsseed=0", "-listen=1", "-addnode=seed:19333"]

  peer2:
    <<: *common
    container_name: azcoin-peer2
    depends_on: [seed]
    volumes:
      - peer2_data:/data
    command: ["-dnsseed=0", "-listen=1", "-addnode=seed:19333"]

volumes:
  seed_data:
  peer1_data:
  peer2_data:
