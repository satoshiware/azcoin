services:
  azcoin:
    # Prebuilt image (build once, run everywhere)
    image: ${AZCOIN_IMAGE}
    build:
      context: ..
      dockerfile: contrib/docker/Dockerfile
    container_name: azcoin
    restart: unless-stopped

    environment:
      # consumed by contrib/docker/entrypoint.sh in the image
      AZCOIN_DATA: ${AZCOIN_DATA:-/data}
      CHAIN: ${CHAIN:-micro}
      MICRO: ${MICRO:-azcoin}
      P2P_PORT: ${P2P_PORT:-19333}
      RPC_PORT: ${RPC_PORT:-19332}
      RPC_USER: ${RPC_USER:-azrpc}
      RPC_PASSWORD: ${RPC_PASSWORD:-azrpcpass}

      # optional bootstrap controls (entrypoint will translate these into -seednode / -connect)
      SEEDNODE_HOST: ${SEEDNODE_HOST:-azcoin_node1.satoshiware.org}
      SEEDNODE_PORT: ${SEEDNODE_PORT:-19333}
      CONNECT_TO: ${CONNECT_TO:-azcoin_node1.satoshiware.org:19333}
      ADDNODE: ${ADDNODE:-node1.azcoin.com:19333}

    volumes:
      - azcoin_data:${AZCOIN_DATA:-/data}

    # P2P must be reachable from other machines
    ports:
      - "${P2P_PORT:-19333}:${P2P_PORT:-19333}"
      # RPC is intentionally NOT published publicly.
      # If you want local host RPC access, uncomment:
      #- "127.0.0.1:${RPC_PORT:-19332}:${RPC_PORT:-19332}"

    command:
      - "-listen=1"
      - "-dnsseed=1"

    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL

volumes:
  azcoin_data:
