services:
  azcoin:
    # Prebuilt image (build once, run everywhere)
    image: ${AZCOIN_IMAGE}
    container_name: azcoin
    restart: unless-stopped

    environment:
      # consumed by contrib/docker/entrypoint.sh in the image
      AZCOIN_DATA: ${AZCOIN_DATA:-/data}
      CHAIN: ${CHAIN:-micro}
      MICRO: ${MICRO:-azcoin}
      P2P_PORT: ${P2P_PORT:-19333}
      RPC_PORT: ${RPC_PORT:-19332}
      RPC_USER: ${RPC_USER:-azrpc}
      RPC_PASSWORD: ${RPC_PASSWORD:-change_me}
      # optional bootstrap controls (entrypoint will translate these into -seednode / -connect)
      SEEDNODE_HOST: ${SEEDNODE_HOST:-}
      SEEDNODE_PORT: ${SEEDNODE_PORT:-}
      CONNECT_TO: ${CONNECT_TO:-}
      ADDNODE: ${ADDNODE:-}

    volumes:
      - azcoin_data:${AZCOIN_DATA:-/data}

    # P2P must be reachable from other machines
    ports:
      - "${P2P_PORT:-19333}:${P2P_PORT:-19333}"
      # RPC is intentionally NOT published publicly.
      # If you want local host RPC access, uncomment:
      # - "127.0.0.1:${RPC_PORT:-19332}:${RPC_PORT:-19332}"

    # Join an existing network (no Docker-only "seed" container)
    # Bootstrap/join behavior is controlled via env vars (so this file stays identical everywhere):
    # - SEEDNODE_HOST / SEEDNODE_PORT: bootstrap peers from a known node (recommended)
    # - CONNECT_TO: strict connect only to one node
    command:
      - "-listen=1"
      - "-dnsseed=1"

volumes:
  azcoin_data:

